package endecryption

import (
	"testing"
)

func TestRSA_Modules2Key(t *testing.T) {
	rsa := &RSA{}
	rsa.SetModules("A7C1B7FEC18E37490ED6F3C989444AC24561B3B7E10C40000" +
		"1EA45013E9BE738FA19DA22E901E187766C153993B053CE16392FA6B7E131E8E5" +
		"92C24CB97241A3EC28EB6DB1250A21E1B3E100E6B6C41D24595734F5C7B43C4236" +
		"2053F7059C612ABBA9235DA89761B1B5A78BC35A7D992A912899E39599FBECAFF50" +
		"39F814BB533055B4D2FFBF3DE684D7A1A3D8075892980766120FE5D835A74629AA" +
		"0EE8B8D39E8CF42CD1100537B7F1810FE8134B5E3696FA30337E903CBA14EDF0A0" +
		"72CB8DAA746A65CFFFEEAB047AFAB58ECABA968BD1602AFC3293F3A293E78113A" +
		"8DE36BE95376F170572428CA2E2C59FDE7EFEED015CC9C8FB20C00FB75BE1DB8DD45")

	rsa.Modules2Key()

	expect := "-----BEGIN PUBLIC KEY-----\n" +
		"MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAp8G3/sGON0kO1vPJiURK\n" +
		"wkVhs7fhDEAAAepFAT6b5zj6Gdoi6QHhh3ZsFTmTsFPOFjkvprfhMejlksJMuXJB\n" +
		"o+wo622xJQoh4bPhAOa2xB0kWVc09ce0PEI2IFP3BZxhKrupI12ol2GxtaeLw1p9\n" +
		"mSqRKJnjlZn77K/1A5+BS7UzBVtNL/vz3mhNeho9gHWJKYB2YSD+XYNadGKaoO6L\n" +
		"jTnoz0LNEQBTe38YEP6BNLXjaW+jAzfpA8uhTt8KByy42qdGplz//uqwR6+rWOyr\n" +
		"qWi9FgKvwyk/Oik+eBE6jeNr6VN28XBXJCjKLixZ/efv7tAVzJyPsgwA+3W+Hbjd\n" +
		"RQIDAQAB\n" +
		"-----END PUBLIC KEY-----\n"

	if expect != rsa.PubKey2String() {
		t.Fatalf("failed to convert modules to pub key")
	}
}
